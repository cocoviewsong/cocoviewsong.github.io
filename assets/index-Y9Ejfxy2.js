import{v as z,d as G,g as x,m as W,E as j,P as q,G as D,s as F,B as J,A as K,e as k,N as O,aa as f,T as Q}from"./index-CGwxC3Dm.js";const[U,b]=z("text-ellipsis"),X={rows:O(1),dots:f("..."),content:f(""),expandText:f(""),collapseText:f(""),position:f("end")};var Y=G({name:U,props:X,emits:["clickAction"],setup(n,{emit:L,slots:v}){const h=x(n.content),u=x(!1),M=x(!1),T=x(),N=x();let H=!1;const S=W(()=>u.value?n.collapseText:n.expandText),w=e=>{if(!e)return 0;const t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0},_=()=>{if(!T.value||!T.value.isConnected)return;const e=window.getComputedStyle(T.value),t=document.createElement("div");return Array.prototype.slice.apply(e).forEach(a=>{t.style.setProperty(a,e.getPropertyValue(a))}),t.style.position="fixed",t.style.zIndex="-9999",t.style.top="-9999px",t.style.height="auto",t.style.minHeight="auto",t.style.maxHeight="auto",t.innerText=n.content,document.body.appendChild(t),t},B=(e,t)=>{var r,a;const{content:c,position:p,dots:m}=n,d=c.length,A=0+d>>1,C=v.action?(a=(r=N.value)==null?void 0:r.outerHTML)!=null?a:"":n.expandText,V=()=>{const o=(s,l)=>{if(l-s<=1)return p==="end"?c.slice(0,s)+m:m+c.slice(l,d);const i=Math.round((s+l)/2);return p==="end"?e.innerText=c.slice(0,i)+m:e.innerText=m+c.slice(i,d),e.innerHTML+=C,e.offsetHeight>t?p==="end"?o(s,i):o(i,l):p==="end"?o(i,l):o(s,i)};return o(0,d)},E=(o,s)=>{if(o[1]-o[0]<=1&&s[1]-s[0]<=1)return c.slice(0,o[0])+m+c.slice(s[1],d);const l=Math.floor((o[0]+o[1])/2),i=Math.ceil((s[0]+s[1])/2);return e.innerText=n.content.slice(0,l)+n.dots+n.content.slice(i,d),e.innerHTML+=C,e.offsetHeight>=t?E([o[0],l],[i,s[1]]):E([l,o[1]],[s[0],i])};return n.position==="middle"?E([0,A],[A,d]):V()},y=()=>{const e=_();if(!e){H=!0;return}const{paddingBottom:t,paddingTop:r,lineHeight:a}=e.style,c=Math.ceil((Number(n.rows)+.5)*w(a)+w(r)+w(t));c<e.offsetHeight?(M.value=!0,h.value=B(e,c)):(M.value=!1,h.value=n.content),document.body.removeChild(e)},g=(e=!u.value)=>{u.value=e},I=e=>{g(),L("clickAction",e)},R=()=>{const e=v.action?v.action({expanded:u.value}):S.value;return k("span",{ref:N,class:b("action"),onClick:I},[e])};return j(()=>{y(),v.action&&q(y)}),D(()=>{H&&(H=!1,y())}),F([J,()=>[n.content,n.rows,n.position]],y),K({toggle:g}),()=>k("div",{ref:T,class:b()},[u.value?n.content:h.value,M.value?R():null])}});const $=Q(Y);export{$ as T};
